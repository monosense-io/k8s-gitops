---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: external-dns-rfc2136
  namespace: networking
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    name: external-dns-rfc2136-secret
    creationPolicy: Owner
    template:
      data:
        RFC2136_HOST: "{{ .RFC2136_HOST }}"
        RFC2136_PORT: "{{ .RFC2136_PORT | default \"53\" }}"
        RFC2136_ZONE: "{{ .RFC2136_ZONE | default \"monosense.io\" }}"
        RFC2136_TSIG_KEYNAME: "{{ .RFC2136_TSIG_KEYNAME }}"
        RFC2136_TSIG_SECRET: "{{ .RFC2136_TSIG_SECRET_BASE64 }}"
        RFC2136_TSIG_ALG: "{{ .RFC2136_TSIG_ALG | default \"hmac-sha256\" }}"
  dataFrom:
    - extract:
        key: kubernetes/infra/rfc2136
