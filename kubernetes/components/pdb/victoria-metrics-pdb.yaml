---
# PodDisruptionBudget for Victoria Metrics vmstorage
# Critical for metrics persistence
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: vmstorage
  namespace: observability
spec:
  # With 3 replicas, allow 1 disruption (2 remain)
  minAvailable: 2
  selector:
    matchLabels:
      app.kubernetes.io/name: vmstorage
      app.kubernetes.io/component: monitoring
---
# PodDisruptionBudget for Victoria Metrics vmselect
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: vmselect
  namespace: observability
spec:
  # With 2 replicas, ensure 1 always available
  minAvailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: vmselect
      app.kubernetes.io/component: monitoring
---
# PodDisruptionBudget for Victoria Metrics vminsert
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: vminsert
  namespace: observability
spec:
  # With 2 replicas, ensure 1 always available
  minAvailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: vminsert
      app.kubernetes.io/component: monitoring
