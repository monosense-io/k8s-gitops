---
# PodDisruptionBudget for Cilium agents
# Ensures minimum pod availability during node maintenance
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: cilium
  namespace: kube-system
spec:
  # Allow disruption of 1 pod at a time (on 3-node cluster, 2 must remain)
  maxUnavailable: 1
  selector:
    matchLabels:
      k8s-app: cilium
---
# PodDisruptionBudget for Cilium Operator
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: cilium-operator
  namespace: kube-system
spec:
  # Operator runs 2 replicas, ensure 1 always available
  minAvailable: 1
  selector:
    matchLabels:
      name: cilium-operator
      io.cilium/app: operator
