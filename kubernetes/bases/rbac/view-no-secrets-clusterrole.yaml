---
# View-Only (No Secrets) ClusterRole
# Purpose: Read-only cluster access for auditors, excluding secret data
# Persona: Security auditors, compliance reviewers
# Validation: Security BLOCKER #1 - RBAC Model
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: view-no-secrets
  labels:
    app.kubernetes.io/managed-by: flux
    rbac.monosense.io/persona: auditor
    rbac.monosense.io/privilege-level: read-only
rules:
  # Read all resources
  - apiGroups: ["*"]
    resources: ["*"]
    verbs: ["get", "list", "watch"]

  # Access API discovery endpoints
  - nonResourceURLs: ["*"]
    verbs: ["get"]

  # Explicitly exclude Secret data
  # Binding will exclude secrets, but documented here for clarity
