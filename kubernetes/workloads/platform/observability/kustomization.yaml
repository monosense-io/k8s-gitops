---
# yaml-language-server: $schema=https://json.schemastore.org/kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - externalsecrets
  - victoria-metrics
  - victoria-logs
  - fluent-bit
  - business-metrics
# Only deploy global VM cluster in infra cluster
# Deploy multi-cluster monitoring components based on cluster
patchesStrategicMerge:
  - |-
    $patch: delete
    apiVersion: kustomize.toolkit.fluxcd.io/v1
    kind: Kustomization
    metadata:
      name: multi-cluster
    $patch: delete
    apiVersion: kustomize.toolkit.fluxcd.io/v1
    kind: Kustomization
    metadata:
      name: victoria-metrics-global
components:
  # Include multi-cluster monitoring components
  - ../../../../components/monitoring/multi-cluster
