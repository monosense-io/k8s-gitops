---
# yaml-language-server: $schema=https://json.schemastore.org/kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - externalsecrets
  - victoria-metrics
  - victoria-logs
  - fluent-bit
  # - business-metrics  # TODO: Fix business metrics integration
# Only deploy global VM cluster in infra cluster
# Deploy multi-cluster monitoring components based on cluster
# Temporarily remove patches - these are trying to delete non-existent resources
# patches:
#   - patch: |
#       $patch: delete
#       apiVersion: kustomize.toolkit.fluxcd.io/v1
#       kind: Kustomization
#       metadata:
#         name: multi-cluster
#   - patch: |
#       $patch: delete
#       apiVersion: kustomize.toolkit.fluxcd.io/v1
#       kind: Kustomization
#       metadata:
#         name: victoria-metrics-global
# Temporarily disable components to fix core deployment first
# components:
#   # Include multi-cluster monitoring components
#   - ../../../../components/monitoring/multi-cluster
#   # Include monitoring network policies for security
#   - ../../../../components/networkpolicy/monitoring
